schemes:
  - http
  - https
basePath: /
definitions:
  handlers.chartOfAccountsResponse:
    properties:
      accounts:
        items:
          $ref: '#/definitions/handlers.ledgerAccount'
        type: array
    type: object
  handlers.ledgerAccount:
    properties:
      allowPostings:
        example: true
        type: boolean
      balance:
        example: "0"
        type: string
      code:
        example: "1000"
        type: string
      currency:
        example: KES
        type: string
      name:
        example: Platform Cash
        type: string
      tenant:
        example: tenant-123
        type: string
      type:
        example: asset
        type: string
    type: object
  handlers.livenessResponse:
    properties:
      service:
        example: treasury-app
        type: string
      status:
        example: ok
        type: string
    type: object
  handlers.paymentIntent:
    properties:
      amount:
        example: "0.00"
        type: string
      currency:
        example: KES
        type: string
      id:
        example: pi_123
        type: string
      status:
        example: pending
        type: string
    type: object
  handlers.paymentIntentsResponse:
    properties:
      intents:
        items:
          $ref: '#/definitions/handlers.paymentIntent'
        type: array
    type: object
  handlers.readinessResponse:
    properties:
      dependencies:
        additionalProperties:
          type: string
        type: object
      status:
        example: OK
        type: string
    type: object
info:
  contact: {}
  description: |
    HTTP API for the BengoBox treasury service.
    
    **Authentication**: All protected endpoints require a Bearer token from auth-service.
    Include the token in the Authorization header: `Authorization: Bearer {token}`
  title: Treasury Service API
  version: 0.1.0
paths:
  /healthz:
    get:
      description: Returns OK when the treasury API process is running.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.livenessResponse'
      summary: Service liveness probe
      tags:
      - Health
  /metrics:
    get:
      description: Exposes Prometheus metrics for scraping.
      produces:
      - text/plain
      responses:
        "200":
          description: Prometheus metrics payload
          schema:
            type: string
      summary: Prometheus metrics
      tags:
      - Health
  /readyz:
    get:
      description: Validates connectivity to Postgres, Redis, NATS, and storage backends.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.readinessResponse'
        "503":
          description: Service Unavailable
          schema:
            $ref: '#/definitions/handlers.readinessResponse'
      summary: Readiness probe
      tags:
      - Health
  /v1/{tenantID}/ledger/chart-of-accounts:
    get:
      description: Returns the ledger chart of accounts for the requesting tenant.
      parameters:
      - description: Tenant identifier
        in: path
        name: tenantID
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.chartOfAccountsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handlers.errorResponse'
      security:
      - bearerAuth: []
      summary: List chart of accounts
      tags:
      - Ledger
  /v1/{tenantID}/payments/intents:
    get:
      description: Returns the payment intents that have been created for the tenant.
      parameters:
      - description: Tenant identifier
        in: path
        name: tenantID
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.paymentIntentsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handlers.errorResponse'
      security:
      - bearerAuth: []
      summary: List payment intents
      tags:
      - Payments
securityDefinitions:
  bearerAuth:
    type: apiKey
    name: Authorization
    in: header
    description: "JWT token from auth-service. Format: Bearer {token}"
swagger: "2.0"
